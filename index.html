<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>One Top Up - Top Up Game</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://unpkg.com/swiper@10/swiper-bundle.min.css" />

    <style>
        /* CSS Kustom yang tidak bisa dilakukan dengan Tailwind langsung */

        /* FAQ - Menambah/Mengurangi ikon pada summary */
        details[open] summary::after {
            content: "−";
        }
        details summary::after {
            content: "+";
            float: right;
            font-weight: bold;
        }

        /* Latar Belakang Kustom untuk Hero Section (jika ingin pakai gambar) */
        .bg-hero-custom {
            background-image: url('images/teemo.png'); /* Pastikan path gambar benar */
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        /* Styling Dark Mode (untuk menimpa default Tailwind atau mengatur properti kompleks) */
        .dark {
            background-color: #1a202c; /* bg-gray-900 */
            color: #e2e8f0; /* text-gray-200 (default text color for dark mode) */
        }
        .dark .bg-white { /* Untuk elemen yang seharusnya putih di mode terang */
            background-color: #2d3748; /* bg-gray-800 */
            color: #e2e8f0; /* Default text color in dark mode for white elements */
        }
        /* Ini adalah heading h3 di bagian "Top Up Disini" */
        /* Kita ingin ini berwarna terang saat dark mode */
        .dark .text-black-700 { /* Khusus untuk heading Top Up Disini */
            color: #e2e8f0 !important; /* Ubah ini menjadi terang saat dark mode */
        }
        .dark .shadow, .dark .shadow-md, .dark .shadow-xl {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.4), 0 2px 4px -1px rgba(0, 0, 0, 0.24);
        }
        .dark .border-transparent {
            border-color: #2d3748; /* Biarkan transparan atau samakan dengan bg */
        }
        .dark .hover\:border-yellow-400:hover {
            border-color: #f6e05e; /* yellow-400 */
        }
        /* Sesuaikan input form di dark mode agar teks inputnya tetap terang */
        .dark .form-input-custom {
            background-color: #4a5568; /* bg-gray-700 */
            color: #e2e8f0; /* Teks input jadi terang */
            border-color: #a0aec0;
        }
        .dark .form-input-custom::placeholder {
            color: #cbd5e0; /* Placeholder juga terang */
        }
        .dark .bg-gray-100 { /* Untuk contact section (yang sebelumnya bg-gray-100) */
            background-color: #1a202c;
        }
        .dark .text-gray-500 {
            color: #a0aec0;
        }
        .dark .text-gray-700 {
            color: #e2e8f0;
        }
        
        /* --- ATURAN UNTUK TEKS FORMULIR DI DARK MODE (Diperbaiki) --- */
        /* Hapus warna teks hitam di Dark Mode untuk form order */
        /* Biarkan label, option, input, placeholder berwarna terang seperti default dark mode */
        .dark #order label,
        .dark #order option,
        .dark #order input::placeholder {
            color: #e2e8f0 !important; /* Teks labels, option, placeholder jadi terang */
        }

        /* Pastikan teks input dan select juga terang saat dark mode */
        .dark #order select,
        .dark #order input {
            color: #e2e8f0 !important; /* Teks yang diketik atau dipilih jadi terang */
            background-color: #4a5568 !important; /* bg-gray-700 untuk input/select bg */
            border-color: #a0aec0 !important; /* border-gray-400 */
        }

        /* Sesuaikan warna teks feedback di dark mode agar tetap terbaca */
        .dark .input-error {
            color: #f87171 !important; /* Merah yang cocok untuk dark mode */
        }
        .dark .input-info {
            color: #4ade80 !important; /* Hijau yang cocok untuk dark mode */
        }

        /* Custom style untuk pesan error/info di bawah input */
        .input-feedback {
            font-size: 0.875rem; /* text-sm */
            margin-top: 0.25rem; /* mt-1 */
        }
        .input-error {
            color: #ef4444; /* text-red-500 */
        }
        .input-info {
            color: #10b981; /* text-green-500 */
        }

        /* --- STYLING BARU UNTUK LATAR BELAKANG KARTU GAME --- */
        .game-card-bg {
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            position: relative; /* Penting untuk overlay */
            overflow: hidden; /* Memastikan overlay tidak keluar */
        }
        .game-card-bg::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.3); /* Overlay hitam transparan */
            transition: background-color 0.3s ease;
        }
        .game-card-bg:hover::before {
             background-color: rgba(0, 0, 0, 0.1); /* Sedikit lebih terang saat hover */
        }

        /* Pastikan konten di atas overlay */
        .game-card-bg img, .game-card-bg h4 {
            position: relative;
            z-index: 10; /* Di atas overlay */
        }

        /* Latar Belakang Spesifik untuk Setiap Game */
        .game-card-mlbb { background-image: url('images/ML-BG.jpg'); }
        .game-card-ff { background-image: url('images/FF-BG.jpg'); }
        .game-card-pubgm { background-image: url('images/PUBGM-BG.jpg'); }
        .game-card-genshin { background-image: url('images/GENSHIN-BG.jpg'); }
        .game-card-valorant { background-image: url('images/VALO-BG.jpg'); }
        .game-card-hok { background-image: url('images/HOK-BG.jpg'); }
        .game-card-pb { background-image: url('images/PB-BG.jpg'); }

        /* Untuk memastikan teks nama game terlihat */
        .game-card-bg h4 {
            color: white; /* Membuat teks nama game putih */
            text-shadow: 1px 1px 3px rgba(0,0,0,0.8); /* Menambah bayangan teks untuk kontras */
        }

    </style>
</head>
<body class="bg-gray-100 text-gray-800 font-sans">

    <header class="bg-gray-800 text-white sticky top-0 z-40 shadow-md">
        <div class="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center">
            <h1 class="text-2xl font-bold text-yellow-400">One Top Up Zone</h1>
            <nav>
                <ul class="flex space-x-6 text-sm md:text-base font-medium">
                    <li><a href="#games" class="hover:text-yellow-300">Game</a></li>
                    <li><a href="#order" class="hover:text-yellow-300">Top Up</a></li>
                    <li><a href="#faq" class="hover:text-yellow-300">FAQ</a></li>
                    <li><a href="#contact" class="hover:text-yellow-300">Kontak</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <div class="swiper mySwiper bg-yellow-100">
        <div class="swiper-wrapper">
            <div class="swiper-slide text-center py-10 font-bold text-lg">🔥 Promo MLBB 170 Diamond cuma 45rb!</div>
            <div class="swiper-slide text-center py-10 font-bold text-lg">🎯 Diskon 20% Genshin Impact top up 300+</div>
            <div class="swiper-slide text-center py-10 font-bold text-lg">💣 Cashback OVO hingga Rp5.000</div>
        </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>
    
    <section class="hero bg-hero-custom text-yellow-400 py-24 text-center">
        <h2 class="text-5xl font-extrabold mb-4 drop-shadow">Top Up Game Murah & Terpercaya!</h2>
        <p class="text-lg opacity-90">Mobile Legends, Free Fire, PUBG Mobile, Genshin Impact, dan banyak lagi!</p>
    </section>

    <section id="games" class="py-20 px-6 max-w-6xl mx-auto">
        <h3 class="text-3xl font-bold mb-10 text-center text-yellow-400">Pilih Game</h3>
        <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-6">

            <div class="group flex flex-col items-center justify-center rounded-xl p-4 border-4 border-transparent hover:border-yellow-400 shadow transition-all duration-300 transform hover:scale-105 hover:shadow-xl game-card-bg game-card-mlbb">
                <img src="images/Mobile-Legend.png" alt="Mobile Legends" class="w-[140px] h-auto mb-3">
                <h4 class="font-semibold text-white opacity-0 group-hover:opacity-100 transition-opacity duration-300">Mobile Legends</h4>
            </div>

            <div class="group flex flex-col items-center justify-center rounded-xl p-4 border-4 border-transparent hover:border-yellow-400 shadow transition-all duration-300 transform hover:scale-105 hover:shadow-xl game-card-bg game-card-ff">
                <img src="images/FF.png" alt="Free Fire" class="w-[140px] h-auto mb-3">
                <h4 class="font-semibold text-white opacity-0 group-hover:opacity-100 transition-opacity duration-300">Free Fire</h4>
            </div>

            <div class="group flex flex-col items-center justify-center rounded-xl p-4 border-4 border-transparent hover:border-yellow-400 shadow transition-all duration-300 transform hover:scale-105 hover:shadow-xl game-card-bg game-card-pubgm">
                <img src="images/PUBGM.png" alt="PUBG Mobile" class="w-[140px] h-auto mb-3">
                <h4 class="font-semibold text-white opacity-0 group-hover:opacity-100 transition-opacity duration-300">PUBG Mobile</h4>
            </div>

            <div class="group flex flex-col items-center justify-center rounded-xl p-4 border-4 border-transparent hover:border-yellow-400 shadow transition-all duration-300 transform hover:scale-105 hover:shadow-xl game-card-bg game-card-genshin">
                <img src="images/Genshin-Impact.png" alt="Genshin Impact" class="w-[140px] h-auto mb-3">
                <h4 class="font-semibold text-white opacity-0 group-hover:opacity-100 transition-opacity duration-300">Genshin Impact</h4>
            </div>

            <div class="group flex flex-col items-center justify-center rounded-xl p-4 border-4 border-transparent hover:border-yellow-400 shadow transition-all duration-300 transform hover:scale-105 hover:shadow-xl game-card-bg game-card-valorant">
                <img src="images/Valorant.png" alt="Valorant" class="w-[140px] h-auto mb-3">
                <h4 class="font-semibold text-white opacity-0 group-hover:opacity-100 transition-opacity duration-300">Valorant</h4>
            </div>

            <div class="group flex flex-col items-center justify-center rounded-xl p-4 border-4 border-transparent hover:border-yellow-400 shadow transition-all duration-300 transform hover:scale-105 hover:shadow-xl game-card-bg game-card-hok">
                <img src="images/HOK.png" alt="Honor Of Kings" class="w-[140px] h-auto mb-3">
                <h4 class="font-semibold text-white opacity-0 group-hover:opacity-100 transition-opacity duration-300">Honor Of Kings</h4>
            </div>

            <div class="group flex flex-col items-center justify-center rounded-xl p-4 border-4 border-transparent hover:border-yellow-400 shadow transition-all duration-300 transform hover:scale-105 hover:shadow-xl game-card-bg game-card-pb">
                <img src="images/PB.png" alt="Point Blank" class="w-[140px] h-auto mb-3">
                <h4 class="font-semibold text-white opacity-0 group-hover:opacity-100 transition-opacity duration-300">Point Blank</h4>
            </div>
        </div>
    </section>

    <section id="order" class="bg-white py-20 px-6 max-w-3xl mx-auto rounded-xl shadow-xl">
        <h3 class="text-3xl font-bold mb-8 text-center text-white-700">⬇️ Top Up Disini ⬇️</h3>
        <form id="topupForm" class="space-y-5">
            <div>
                <label for="gameSelect" class="block font-semibold mb-1">Pilih Game</label>
                <select id="gameSelect" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-500 dark:form-input-custom" required>
                    <option value="">🎮 Pilih Game 🎮</option>
                    <option>Mobile Legends</option>
                    <option>Free Fire</option>
                    <option>PUBG Mobile</option>
                    <option>Genshin Impact</option>
                    <option>Valorant</option>
                    <option>Honor Of Kings</option>
                    <option>Point Blank</option>
                </select>
                <div id="gameSelect-feedback" class="input-feedback"></div>
            </div>

            <div>
                <label for="userID" class="block font-semibold mb-1">User ID</label>
                <input type="text" id="userID" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-500 dark:form-input-custom" placeholder="Masukkan User ID" required />
                <div id="userID-feedback" class="input-feedback"></div>
            </div>

            <div>
                <label for="diamondSelect" class="block font-semibold mb-1">Jumlah Diamond / UC</label>
                <select id="diamondSelect" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-500 dark:form-input-custom" required>
                    <option value="">💎 Jumlah Diamond 💎</option>
                </select>
                <div id="diamondSelect-feedback" class="input-feedback"></div>
                <div id="priceDisplay" class="mt-2 text-sm text-green-700 font-medium"></div>
            </div>

            <div>
                <label for="paymentMethod" class="block font-semibold mb-1">Metode Pembayaran</label>
                <select id="paymentMethod" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-500 dark:form-input-custom" required>
                    <option value="">💵 Pilih Pembayaran 💵</option>
                    <option>QRIS</option>
                    <option>OVO</option>
                    <option>DANA</option>
                    <option>GOPAY</option>
                    <option>Transfer Bank</option>
                </select>
                <div id="paymentMethod-feedback" class="input-feedback"></div>
            </div>

            <div>
                <label for="email" class="block font-semibold mb-1">Email</label>
                <input type="email" id="email" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-500 dark:form-input-custom" placeholder="Masukan Alamat Email Anda" required />
                <div id="email-feedback" class="input-feedback"></div>
            </div>

            <button type="submit" id="submitButton" class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded w-full transition-colors duration-300">Kirim Pesanan</button>
        </form>
        <p id="successMsg" class="mt-4 text-green-600 text-center hidden">✅ Pesanan berhasil dikirim!</p>
    </section>

    <a href="https://wa.me/6281234567890" class="fixed bottom-6 right-6 bg-green-500 p-3 rounded-full shadow-lg z-50 hover:bg-green-600" title="Chat via WhatsApp" target="_blank">
        <svg xmlns="http://www.w3.org/2000/svg" fill="white" viewBox="0 0 24 24" width="28" height="28">
            <path d="M12 0C5.4 0 0 5.4 0 12c0 2.1.5 4 1.4 5.8L0 24l6.3-1.6C8.1 23.5 10 24 12 24c6.6 0 12-5.4 12-12S18.6 0 12 0zm0 21.6c-1.8 0-3.5-.5-5.1-1.4l-.4-.3-3.8 1 1-3.7-.2-.4C2.9 15.6 2.4 13.9 2.4 12c0-5.3 4.3-9.6 9.6-9.6S21.6 6.7 21.6 12 17.3 21.6 12 21.6z"/>
            <path d="M17.6 14.5c-.3-.1-1.6-.8-1.9-.9-.3-.1-.5-.2-.7.1s-.8.9-1 .1c-.3-.7-.6-.9-1.2-1.3-.4-.3-.6-.2-.9 0-.3.2-.7.8-.9 1.1-.2.2-.5.2-.8.1-.8-.3-1.5-.7-2.1-1.3-.5-.5-1-1.2-1.3-2-.1-.3 0-.6.1-.8.2-.2.5-.5.7-.8.2-.3.3-.5.5-.9.1-.3 0-.6-.1-.9-.1-.3-.7-1.7-1-2.3-.2-.4-.4-.4-.7-.4-.2 0-.6 0-1 .4C5 4.3 3.9 6 4 8c.1 2.4 1.2 4.5 2.7 6.1 1.6 1.6 3.7 2.6 6.1 2.7 2.1.1 3.7-.9 4.3-1.5.4-.4.5-.6.6-.8.1-.2.1-.4-.2-.5z"/>
        </svg>
    </a>

    <section id="faq" class="py-16 px-4 max-w-4xl mx-auto">
        <h2 class="text-3xl font-bold mb-6 text-center">❓ FAQ</h2>
        <div class="space-y-4">
            <details class="bg-white p-4 rounded shadow">
                <summary class="font-semibold cursor-pointer">Bagaimana cara top up?</summary>
                <p class="mt-2 text-sm text-gray-700">Pilih game, jumlah diamond, isi data, lalu kirim pesanan.</p>
            </details>
            <details class="bg-white p-4 rounded shadow">
                <summary class="font-semibold cursor-pointer">Berapa lama proses top up?</summary>
                <p class="mt-2 text-sm text-gray-700">Proses 1–10 menit, maksimal 1 jam. Hubungi kami jika belum masuk.</p>
            </details>
            <details class="bg-white p-4 rounded shadow">
                <summary class="font-semibold cursor-pointer">Apakah aman?</summary>
                <p class="mt-2 text-sm text-gray-700">100% aman dan legal, ribuan pengguna sudah membuktikan.</p>
            </details>
        </div>
    </section>

    <section id="contact" class="py-20 text-center bg-gray-800 text-white">
        <h3 class="text-3xl font-bold mb-4">Hubungi Kami</h3>
        <p class="mb-2">WhatsApp: <a href="https://wa.me/6281234567890" class="text-white underline" target="_blank">+62 812-3456-7890</a></p>
        <p>Email: <a href="mailto:support@topupzone.com" class="text-white underline">support@topupzone.com</a></p>
        <p class="text-sm mt-6 text-white text-opacity-70">© 2025 One Top Up Zone. All rights reserved.</p>
    </section>

    <div class="fixed top-4 right-4 z-50">
        <button id="toggleDark" class="bg-black text-white px-3 py-1 rounded shadow text-sm">Dark Mode</button>
    </div>

    <script src="https://unpkg.com/swiper@10/swiper-bundle.min.js"></script>
    <script>
        // --- 1. Swiper Slider Initialization ---
        new Swiper(".mySwiper", {
            loop: true,
            autoplay: {
                delay: 4000,
                disableOnInteraction: false,
            },
            pagination: {
                el: '.swiper-pagination',
                clickable: true,
            },
            navigation: {
                nextEl: '.swiper-button-next',
                prevEl: '.swiper-button-prev',
            },
        });

        // --- 2. Dark Mode Toggle ---
        const toggleDark = document.getElementById('toggleDark');
        toggleDark.addEventListener('click', () => {
            document.body.classList.toggle('dark');
            localStorage.setItem('theme', document.body.classList.contains('dark') ? 'dark' : 'light');
            toggleDark.textContent = document.body.classList.contains('dark') ? 'Light Mode' : 'Dark Mode';
        });
        // Set initial state from localStorage
        if (localStorage.getItem('theme') === 'dark') {
            document.body.classList.add('dark');
            toggleDark.textContent = 'Light Mode';
        } else {
            toggleDark.textContent = 'Dark Mode';
        }

        // --- 3. Form Logic & Data (Game Options, Prices, Nickname Simulation) ---
        const form = document.getElementById('topupForm');
        const gameSelect = document.getElementById('gameSelect');
        const userIDInput = document.getElementById('userID');
        const diamondSelect = document.getElementById('diamondSelect');
        const paymentMethodSelect = document.getElementById('paymentMethod');
        const emailInput = document.getElementById('email');
        const submitButton = document.getElementById('submitButton');

        const successMsg = document.getElementById('successMsg');
        const priceDisplay = document.getElementById('priceDisplay');

        // Feedback elements for validation
        const gameSelectFeedback = document.getElementById('gameSelect-feedback');
        const userIDFeedback = document.getElementById('userID-feedback');
        const diamondSelectFeedback = document.getElementById('diamondSelect-feedback');
        const paymentMethodFeedback = document.getElementById('paymentMethod-feedback');
        const emailFeedback = document.getElementById('email-feedback');

        const diamondOptions = {
            "Mobile Legends": [12, 28, 36, 56, 85, 170, 257, 344, 429, 514, 706, 878, 963, 1050, 1412, 2195],
            "Free Fire": [5, 20, 50, 70, 100, 140, 210, 280, 355, 720, 1000, 1440, 2010, 4000],
            "PUBG Mobile": [60, 180, 325, 660, 1800, 3850, 8100],
            "Genshin Impact": [60, 300, 980, 1980, 3280, 6480],
            "Valorant": [125, 420, 700, 1375, 2400, 4000, 8150],
            "Honor Of Kings": [11, 22, 45, 90, 225, 450, 900, 1800],
            "Point Blank": [1200, 2400, 6000, 12000, 24000, 60000]
        };

        const priceMap = {
            "Mobile Legends": {
                12: 3000, 28: 7000, 36: 9000, 56: 14000, 85: 21000, 170: 45000, 257: 67000, 344: 88000, 429: 110000, 514: 130000, 706: 175000, 878: 220000, 963: 240000, 1050: 260000, 1412: 350000, 2195: 540000
            },
            "Free Fire": {
                5: 1000, 20: 3000, 50: 7000, 70: 9000, 100: 13000, 140: 18000, 210: 27000, 280: 36000, 355: 45000, 720: 90000, 1000: 125000, 1440: 180000, 2010: 250000, 4000: 500000
            },
            "PUBG Mobile": {
                60: 15000, 180: 45000, 325: 80000, 660: 160000, 1800: 400000, 3850: 850000, 8100: 1750000
            },
            "Genshin Impact": {
                60: 16000, 300: 78000, 980: 250000, 1980: 490000, 3280: 800000, 6480: 1600000
            },
            "Valorant": {
                125: 15000, 420: 50000, 700: 80000, 1375: 150000, 2400: 250000, 4000: 400000, 8150: 800000
            },
            "Honor Of Kings": {
                11: 3000, 22: 6000, 45: 12000, 90: 24000, 225: 60000, 450: 120000, 900: 240000, 1800: 480000
            },
            "Point Blank": {
                1200: 12000, 2400: 24000, 6000: 60000, 12000: 120000, 24000: 240000, 60000: 600000
            }
        };

        // Simulated Nickname Database (In real app, this would be an API call)
        const gameNicknames = {
            "Mobile Legends": {
                "12345678": "ProPlayerMLBB",
                "87654321": "NoobSlayer",
                "99999999": "MythicLegend"
            },
            "Free Fire": {
                "11223344": "GarenaPro",
                "55667788": "HeadshotKing"
            },
            "Genshin Impact": {
                "100000000": "TravelerAether",
                "100000001": "Luminesce"
            },
            // Add more games and IDs/nicknames as needed
        };

        // --- 4. Form Event Listeners & Functions ---

        // Function to clear feedback messages
        function clearFeedback() {
            gameSelectFeedback.textContent = '';
            gameSelectFeedback.className = 'input-feedback';
            userIDFeedback.textContent = '';
            userIDFeedback.className = 'input-feedback';
            diamondSelectFeedback.textContent = '';
            diamondSelectFeedback.className = 'input-feedback';
            paymentMethodFeedback.textContent = '';
            paymentMethodFeedback.className = 'input-feedback';
            emailFeedback.textContent = '';
            emailFeedback.className = 'input-feedback';
        }

        // Function to display feedback
        function showFeedback(element, message, type = 'error') {
            element.textContent = message;
            element.className = `input-feedback input-${type}`;
        }

        // Handle Game Selection Change
        gameSelect.addEventListener('change', function () {
            const selectedGame = this.value;
            const options = diamondOptions[selectedGame] || [];
            diamondSelect.innerHTML = '<option value="">💎 Jumlah Diamond 💎</option>';
            options.forEach(value => {
                const opt = document.createElement('option');
                opt.value = value;
                opt.textContent = value;
                diamondSelect.appendChild(opt);
            });
            priceDisplay.textContent = ''; // Reset price when game changes
            userIDInput.value = ''; // Clear User ID
            userIDFeedback.textContent = ''; // Clear User ID feedback
            userIDFeedback.className = 'input-feedback';
            
            // Clear diamond select if game selection invalid
            if (!selectedGame) {
                diamondSelect.innerHTML = '<option value="">💎 Jumlah Diamond 💎</option>';
            }
            saveFormState(); // Save state
        });

        // Handle User ID Input Change (Simulated Validation)
        userIDInput.addEventListener('input', function() {
            const selectedGame = gameSelect.value;
            const userID = this.value.trim();
            userIDFeedback.textContent = ''; // Clear previous feedback

            if (!selectedGame) { // If no game selected, can't validate ID
                showFeedback(userIDFeedback, 'Pilih game terlebih dahulu untuk validasi ID.', 'error');
                return;
            }

            if (userID.length < 5) { // Simple length check
                showFeedback(userIDFeedback, 'User ID terlalu pendek', 'error');
                return;
            }

            // Simulate API call delay for nickname lookup
            showFeedback(userIDFeedback, 'Mengecek User ID...', 'info');
            setTimeout(() => {
                if (gameNicknames[selectedGame] && gameNicknames[selectedGame][userID]) {
                    const nickname = gameNicknames[selectedGame][userID];
                    showFeedback(userIDFeedback, `Nickname: ${nickname}`, 'info');
                } else {
                    showFeedback(userIDFeedback, 'User ID tidak ditemukan atau tidak valid', 'error');
                }
            }, 500); // 0.5 second delay for simulation
            saveFormState(); // Save state
        });
        // Clear nickname when user ID input is focused
        userIDInput.addEventListener('focus', function() {
            if (userIDFeedback.classList.contains('input-info') || userIDFeedback.classList.contains('input-error')) {
                userIDFeedback.textContent = '';
                userIDFeedback.className = 'input-feedback';
            }
        });


        // Handle Diamond Selection Change (Update Price)
        diamondSelect.addEventListener('change', () => {
            const game = gameSelect.value;
            const qty = diamondSelect.value;
            const price = priceMap?.[game]?.[qty];
            priceDisplay.textContent = price ? `Estimasi Harga: Rp${price.toLocaleString('id-ID')}` : '';
            saveFormState(); // Save state
        });
        
        // Save other form elements on input
        paymentMethodSelect.addEventListener('change', saveFormState);
        emailInput.addEventListener('input', saveFormState);


        // --- 5. Form Submission Logic ---
        form.addEventListener('submit', function(event) {
            event.preventDefault(); // Prevent default form submission

            clearFeedback(); // Clear all previous feedback messages

            let isValid = true; // Flag for form validation

            // Manual Validation for each field
            if (!gameSelect.value) {
                showFeedback(gameSelectFeedback, 'Pilih game terlebih dahulu.', 'error');
                isValid = false;
            }
            if (!userIDInput.value.trim()) {
                showFeedback(userIDFeedback, 'Masukkan User ID Anda.', 'error');
                isValid = false;
            } else {
                // Ensure User ID is validated and nickname found before proceeding
                const selectedGame = gameSelect.value;
                const userID = userIDInput.value.trim();
                if (!gameNicknames[selectedGame] || !gameNicknames[selectedGame][userID]) {
                     showFeedback(userIDFeedback, 'User ID tidak valid atau tidak ditemukan.', 'error');
                     isValid = false;
                }
            }

            if (!diamondSelect.value) {
                showFeedback(diamondSelectFeedback, 'Pilih jumlah diamond/UC.', 'error');
                isValid = false;
            }
            if (!paymentMethodSelect.value) {
                showFeedback(paymentMethodFeedback, 'Pilih metode pembayaran.', 'error');
                isValid = false;
            }
            if (!emailInput.value.trim() || !emailInput.value.includes('@') || !emailInput.value.includes('.')) {
                showFeedback(emailFeedback, 'Masukkan alamat email yang valid.', 'error');
                isValid = false;
            }

            if (!isValid) {
                successMsg.classList.add('hidden'); // Hide success message if validation fails
                return; // Stop the submission
            }

            // Show loading state on button
            submitButton.textContent = 'Memproses Pesanan...';
            submitButton.disabled = true;
            submitButton.classList.add('opacity-70', 'cursor-not-allowed');

            // Simulate API call (replace with actual backend call)
            setTimeout(() => {
                const selectedGame = gameSelect.value;
                const selectedDiamonds = diamondSelect.value;
                const userID = userIDInput.value.trim();
                const email = emailInput.value.trim();
                const paymentMethod = paymentMethodSelect.value;
                const estimatedPrice = priceMap?.[selectedGame]?.[selectedDiamonds];
                const nickname = gameNicknames[selectedGame]?.[userID] || "N/A"; // Get validated nickname

                console.log("Pesanan Baru:");
                console.log("Game:", selectedGame);
                console.log("Jumlah Diamond/UC:", selectedDiamonds);
                console.log("User ID:", userID, "(Nickname:", nickname + ")");
                console.log("Email:", email);
                console.log("Metode Pembayaran:", paymentMethod);
                console.log("Estimasi Harga:", estimatedPrice ? `Rp${estimatedPrice.toLocaleString('id-ID')}` : 'Tidak tersedia');

                // Show success message
                successMsg.classList.remove('hidden');

                // Reset button state
                submitButton.textContent = 'Kirim Pesanan';
                submitButton.disabled = false;
                submitButton.classList.remove('opacity-70', 'cursor-not-allowed');

                // Reset form and clear localStorage after a delay
                setTimeout(() => {
                    form.reset();
                    clearFeedback(); // Clear all feedback after reset
                    successMsg.classList.add('hidden');
                    priceDisplay.textContent = ''; // Clear price display
                    // Clear localStorage for all form inputs
                    form.querySelectorAll('input[id], select[id]').forEach(input => localStorage.removeItem(input.id));
                }, 3000); // Pesan akan hilang setelah 3 detik

                // Open WhatsApp with pre-filled message
                const whatsappMessage = `Halo One Top Up Zone, saya ingin top up game:
                Game: ${selectedGame}
                Jumlah: ${selectedDiamonds}
                User ID: ${userID}
                Nickname: ${nickname}
                Email: ${email}
                Metode Pembayaran: ${paymentMethod}
                Estimasi Harga: ${estimatedPrice ? `Rp${estimatedPrice.toLocaleString('id-ID')}` : 'Tidak tersedia'}

                Terima kasih!`;

                const encodedMessage = encodeURIComponent(whatsappMessage);
                const whatsappLink = `https://wa.me/6281234567890?text=${encodedMessage}`;
                window.open(whatsappLink, '_blank'); // Open in new tab
            }, 1000); // Simulate network delay
        });

        // --- 6. Local Storage for Form State ---
        function saveFormState() {
            form.querySelectorAll('input[id], select[id]').forEach(input => {
                localStorage.setItem(input.id, input.value);
            });
        }

        // --- 7. Game Image Click & Auto-Select ---
        document.querySelectorAll('#games img').forEach(img => {
            img.style.cursor = 'pointer';
            img.addEventListener('click', () => {
                const gameName = img.alt;
                gameSelect.value = gameName;
                gameSelect.dispatchEvent(new Event('change')); // Trigger change to populate diamonds
                document.getElementById('order').scrollIntoView({ behavior: 'smooth' });
                saveFormState(); // Save state
            });
        });

        // --- 8. Load Initial Form State on Page Load ---
        document.addEventListener('DOMContentLoaded', () => {
            // Load saved values
            form.querySelectorAll('input[id], select[id]').forEach(input => {
                const savedValue = localStorage.getItem(input.id);
                if (savedValue) {
                    input.value = savedValue;
                }
            });

            // Manually trigger change for gameSelect to populate diamond options
            if (gameSelect.value) {
                gameSelect.dispatchEvent(new Event('change'));
            }
            // Manually trigger input for userID to show nickname feedback
            if (userIDInput.value) {
                userIDInput.dispatchEvent(new Event('input'));
            }
            // Manually trigger change for diamondSelect to update price
            if (diamondSelect.value) {
                diamondSelect.dispatchEvent(new Event('change'));
            }
        });
    </script>
</body>
</html>
